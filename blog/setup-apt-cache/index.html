<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Set up a cache for deb packages | Tangamandapio</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (eo)" href="../../eo/rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../es/rss.xml">
<link rel="canonical" href="http://elopio.net/blog/setup-apt-cache/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Leo Arias">
<link rel="prev" href="../ubuntu-testing-day-wrap-up-20161202/" title="Ubuntu Testing Day wrap up - 20161202" type="text/html">
<link rel="next" href="../ubuntu-testing-day-wrap-up-20161209/" title="Ubuntu Testing Day wrap up - Unity8 (20161209)" type="text/html">
<meta property="og:site_name" content="Tangamandapio">
<meta property="og:title" content="Set up a cache for deb packages">
<meta property="og:url" content="http://elopio.net/blog/setup-apt-cache/">
<meta property="og:description" content="All Linux distributions are constantly updating the versions of the packages in their archives. That’s what makes them great, lots of people working in a distributed way to let you easily update your ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-12-08T19:43:13-06:00">
<meta property="article:tag" content="free software">
<meta property="article:tag" content="testing">
<meta property="article:tag" content="ubuntu">
<link rel="alternate" hreflang="eo" href="../../eo/blog/setup-apt-cache/">
<link rel="alternate" hreflang="es" href="../../es/blog/setup-apt-cache/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://elopio.net/">

                <span id="blog-title">Tangamandapio</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
                </li>
<li>
<a href="../../notebook">Notebook</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
            </li>
<li><a href="http://elopio.net/eo/" rel="alternate" hreflang="eo">Esperante</a></li>
            <li><a href="http://elopio.net/es/" rel="alternate" hreflang="es">Español</a></li>

                
                    
    <li>
    <a href="index.tex" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Set up a cache for deb packages</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    Leo Arias
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2016-12-08T19:43:13-06:00" itemprop="datePublished" title="2016-12-08 19:43">2016-12-08 19:43</time></a></p>
            
        <p class="sourceline"><a href="index.tex" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>All Linux distributions are constantly updating the versions of the packages in their archives. That’s what makes them great, lots of people working in a distributed way to let you easily update your software and get the latest features or critical bug fixes.</p>
<p>And you should constatly update your operating system. Otherwise you’ll become an easy target for criminals exploiting known vulnerabilities.</p>
<p>The problem, at least for me, is that I have many many Ubuntu machines in the house and my badwidth is really bad. So keeping all my real machines, virtual machines and various devices up-to-date every day has become a slow problem.</p>
<p>The solution is to cache the downloaded deb packages. So only one machine has to make the downloads from the internet, and they will be kept in my local network to make much faster to get the packages in the other machines.</p>
<p>So let me introduce you to <a href="https://www.unix-ag.uni-kl.de/~bloch/acng/">Apt-Cacher NG</a>.</p>
<p>Setting it up is simple. First, choose a machine to run the cacher and store the packages. Ideally, this machine should be running all the time, and should have a good amount of storage space. I’m using my desktop as the cacher; but as soon as I update my router to one that runs Ubuntu, I will make that one the cacher.</p>
<p>On that machine, install apt-cacher-ng:</p>
<pre><code>  sudo apt install apt-cacher-ng</code></pre>
<p>And that’s it. The cacher is installed and configured. Now we need the name of this machine to use it on the other ones:</p>
<pre><code>  $ hostname
  calchas</code></pre>
<p>In this example, <em>calchas</em> is the name of the machine I’m using as the cacher. Take note of the name of your machine, and now, in all the other machines:</p>
<pre><code>  $ sudo gedit /etc/apt/apt.conf.d/02proxy</code></pre>
<p>That will create a new empty configuration file for <em>apt</em>, and open it to be edited with <em>gedit</em>, the default graphical editor in Ubuntu. In the editor, write this:</p>
<pre><code>  Acquire::http::proxy "http://calchas.lan:3142";</code></pre>
<p>replacing <em>calchas</em> with the name of your cacher machine, collected above. The <em>.lan</em> part is really only needed when you are setting it up in a virtual machine and the host is the same as the cacher, but it doesn’t hurt to add it on real machines. That number, <em>3142</em>, is the network port where the caching service is running, leave it unchanged.</p>
<p>After that, the first time you update a package in your network it will be slow just as before. But all the other machines updating the same package will be very fast. I have to thank <em>apt-cacher-ng</em> for saving me many hours during my updates of the past years.</p>
<div class="references">

</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/free-software/" rel="tag">free software</a></li>
            <li><a class="tag p-category" href="../../categories/testing/" rel="tag">testing</a></li>
            <li><a class="tag p-category" href="../../categories/ubuntu/" rel="tag">ubuntu</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../ubuntu-testing-day-wrap-up-20161202/" rel="prev" title="Ubuntu Testing Day wrap up - 20161202">Previous post</a>
            </li>
            <li class="next">
                <a href="../ubuntu-testing-day-wrap-up-20161209/" rel="next" title="Ubuntu Testing Day wrap up - Unity8 (20161209)">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>Licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>. - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
